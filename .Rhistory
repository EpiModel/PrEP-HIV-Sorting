d.neg.part <- cbind(cbind(c(b$n[1], b$n[4], b$n[7])),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * b$n[7] / a$n[3])
)))
d.neg.part
# Positive partners
d.pos.part <- cbind(cbind(c(b$n[2], b$n[5], b$n[8])),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * b$n[8] / a$n[3]))))
d.pos.part
c <- artnetLong %>% count(p_hiv)
c
# Negative partners
d.neg.part <- cbind(cbind(c(b$n[1], b$n[4], b$n[7], c$n[1])),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * b$n[7] / a$n[3]),
(100 * c$n[1] / sum(c$n)))))
d.neg.part
# Positive partners
d.pos.part <- cbind(cbind(c(b$n[2], b$n[5], b$n[8], c$n[2])),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * b$n[8] / a$n[3]),
(100 * c$n[2] / sum(c$n)))))
d.pos.part
# HIV unknown partners
d.unk.part <- cbind(cbind(c(b$n[3], b$n[6], b$n[9], c$n[3])),
cbind(rbind((100 * b$n[3] / a$n[1]),
(100 * b$n[6] / a$n[2]),
(100 * b$n[9] / a$n[3]),
(100 * c$n[3] / sum(c$n)))))
d.unk.part
table2a <- cbind(totalHIV.ego, d.neg.part, d.pos.part, d.unk.part)
# HIV distribution among egos
totalHIV.ego <- cbind(cbind(c("Negative", "Positive", "Unknown", "Total")),
cbind(c(a$n[1], a$n[2], a$n[3], sum(a$n))),
cbind(rbind((100 * a$n[1] / sum(a$n)),
(100 * a$n[2] / sum(a$n)),
(100 * a$n[3] / sum(a$n)),
(100 * sum(a$n) / sum(a$n)))))
table2a <- cbind(totalHIV.ego, d.neg.part, d.pos.part, d.unk.part)
table2a
table2a
table2a.title
table2a.title <- c("", "", "", "Alters", "", "", "", "", "")
table2a.title
table2a.title <- c(, "", "", "Alters", "", "", "", "", "")
""
table2a.title <- c("", "", "", "Alters", "", "", "", "", "")
table2a <- rbind(table2a.title, table2a.colnames,
cbind(totalHIV.ego, d.neg.part, d.pos.part, d.unk.part))
table2a.title <- c("", "", "", "Alters", "", "", "", "", "")
table2a.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%", "Unknown n", "%")
table2a <- rbind(table2a.title, table2a.colnames,
cbind(totalHIV.ego, d.neg.part, d.pos.part, d.unk.part))
table2a
table2a
write.csv(table2a, file = "aim1_table2a.csv")
count(hi2)
count(hiv2)
count(artnetLong$hiv2)
artnetLong %>% count(hiv2)
artnetLong %>% count(hiv3)
artnetLong %>% count(p_hiv)
# HIV distribution among egos
totalHIV.ego.known <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c(a$n[1], a$n[2], a$n[1] + a$n[2])),
cbind(rbind((100 * a$n[1] / (a$n[1] + a$n[2])),
(100 * a$n[2] / (a$n[1] + a$n[2])),
(100 * (a$n[1] + a$n[2]) / (a$n[1] + a$n[2])))))
totalHIV.ego.known
b <- artnetLong %>% count(d_hiv) #HIV by dyad pair
b
c
a
# Negative partners
d.neg.known.part <- cbind(cbind(c(b$n[1], b$n[4], c$n[1])),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * c$n[1] / (c$n[1] + c$n[2])))))
# Positive partners
d.pos.known.part <- cbind(cbind(c(b$n[2], b$n[5], c$n[2])),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * c$n[2] / (c$n[1] + c$n[2])))))
d.neg.known.part
b
# Negative partners
d.neg.known.part <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
d.neg.known.part
b
a
b
# HIV distribution among egos
totalHIV.ego.known <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[3] + b$n[4])),
cbind(rbind((100 * a$n[1] / (a$n[1] + a$n[2])),
(100 * a$n[2] / (a$n[1] + a$n[2])),
(100 * (a$n[1] + a$n[2]) / (a$n[1] + a$n[2]))))))
totalHIV.ego.known
b
# HIV distribution among egos
totalHIV.ego.known <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * a$n[1] / (a$n[1] + a$n[2])),
(100 * a$n[2] / (a$n[1] + a$n[2])),
(100 * (a$n[1] + a$n[2]) / (a$n[1] + a$n[2]))))))
totalHIV.ego.known
b
# HIV distribution among egos
totalHIV.ego.known <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * (b$n[1] + b$n[2]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[2] + b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5]))))))
totalHIV.ego.known
# Negative partners
d.neg.known.part <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
# HIV distribution among egos
totalHIV.known.ego <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * (b$n[1] + b$n[2]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[2] + b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5]))))))
# Positive partners
d.pos.known.part <- cbind(cbind(c(b$n[2], b$n[5], (b$n[2] + b$n[5]))),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * (b$n[2] + b$n[5]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
d.neg.known.part
# HIV distribution among egos
totalHIV.ego.known <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * (b$n[1] + b$n[2]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[2] + b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5]))))))
# Negative partners
d.neg.part.known <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
# Positive partners
d.pos.part.known <- cbind(cbind(c(b$n[2], b$n[5], (b$n[2] + b$n[5]))),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * (b$n[2] + b$n[5]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
table2b(cbind(totalHIV.ego.known, d.neg.part.known, d.pos.part.known))
table2b <- cbind(totalHIV.ego.known, d.neg.part.known, d.pos.part.known)
table2b
table2b.title <- c("Conditional on HIV reported Negative or Positive", "", "", "Alters", "", "", "")
table2b.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%")
table2b <- rbind(table2b.title, table2b.colnames,
cbind(totalHIV.ego.known, d.neg.part.known, d.pos.part.known))
table2b
write.csv(table2b, file = "aim1_table2b.csv")
b
# Negative partners
d.neg.part.known <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / (b$n[1] + b$n[2])),
(100 * b$n[4] / (b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
# Positive partners
d.pos.part.known <- cbind(cbind(c(b$n[2], b$n[5], (b$n[2] + b$n[5]))),
cbind(rbind((100 * b$n[2] / (b$n[1] + b$n[2])),
(100 * b$n[5] / (b$n[4] + b$n[5])),
(100 * (b$n[2] + b$n[5]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
table2b <- rbind(table2b.title, table2b.colnames,
cbind(totalHIV.ego.known, d.neg.part.known, d.pos.part.known))
write.csv(table2b, file = "aim1_table2b.csv")
nrow(artnet)
# Lists the column names
# names(artnet)
###Table 1 - Demographic Characteristics
# Total Sample
total <- cbind("Total",
nrow(artnet), nrow(artnet) / nrow(artnet),
nrow(artnetLong), nrow(artnetLong) / nrow(artnetLong)
)
# Age Category
a <- artnet %>% count(age.cat)
age.ego <- cbind(cbind(c(a$age.cat[1], a$age.cat[2], a$age.cat[3],
a$age.cat[4], a$age.cat[5], "66+")),
cbind(c(a$n[1], a$n[2], a$n[3], a$n[4], a$n[5],
ifelse(length(which(artnet$age.cat == "66+")) > 0, a$n[6], 0))),
cbind(rbind((100 * a$n[1] / sum(a$n)),
(100 * a$n[2] / sum(a$n)),
(100 * a$n[3] / sum(a$n)),
(100 * a$n[4] / sum(a$n)),
(100 * a$n[5] / sum(a$n)),
(100 * a$n[6] / sum(a$n)))))
# Using imputed age
b <- artnetLong %>% count(p_age.cat_imp)
age.part <- cbind(cbind(c(b$n[1], b$n[2], b$n[3], b$n[4], b$n[5],
ifelse(length(which(artnetLong$p_age.cat_imp == "66+")) > 0, b$n[6], 0))),
cbind(rbind((100 * b$n[1] / sum(b$n)),
(100 * b$n[2] / sum(b$n)),
(100 * b$n[3] / sum(b$n)),
(100 * b$n[4] / sum(b$n)),
(100 * b$n[5] / sum(b$n)),
(100 * b$n[6] / sum(b$n)))))
# Race/ethnicity
a <- artnet %>% count(race.cat)
race.ego <- cbind(cbind(c(a$race.cat[1], a$race.cat[4], a$race.cat[2], a$race.cat[3])),
cbind(c(a$n[1], a$n[4], a$n[2], a$n[3])),
cbind(rbind((100 * a$n[1] / sum(a$n)),
(100 * a$n[4] / sum(a$n)),
(100 * a$n[2] / sum(a$n)),
(100 * a$n[3] / sum(a$n)))))
b <- artnetLong %>% count(p_race.cat)
race.part <- cbind(cbind(c(b$n[1], b$n[4], b$n[2], b$n[3])),
cbind(rbind((100 * b$n[1] / sum(b$n)),
(100 * b$n[4] / sum(b$n)),
(100 * b$n[2] / sum(b$n)),
(100 * b$n[3] / sum(b$n)))))
# HIV
a <- artnet %>% count(hiv3)
hiv.ego <- cbind(cbind(c("Negative", "Positive", "Unknown", NA)),
cbind(c(a$n[1], a$n[2], a$n[3], NA)), #a$n[4]),
cbind(rbind((100 * a$n[1] / sum(a$n[1:3])),
(100 * a$n[2] / sum(a$n[1:3])),
(100 * a$n[3] / sum(a$n[1:3])),
NA)))
b <- artnetLong %>% count(p_hiv)
hiv.part <- cbind(cbind(c(b$n[1], b$n[2], b$n[3], b$n[4])), #b$n[4]),
cbind(rbind((100 * b$n[1] / sum(b$n[1:3])),
(100 * b$n[2] / sum(b$n[1:3])),
(100 * b$n[3] / sum(b$n[1:3])),
NA)))
table1 <- rbind(total,
cbind(age.ego, age.part),
cbind(race.ego, race.part),
cbind(hiv.ego, hiv.part)
)
colnames(table1) <- c("Category", "Egos N", "Egos %", "Partners N", "Partners %")
write.csv(table1, file = "aim1_table1.csv")
(b <- artnetLong %>% count(ptype)) #HIV by dyad pair
a <- artnetLong %>% filter(ptype == 1) %>% count(ptype)  #HIV among egos
a
a <- artnetLong %>% filter(ptype == 1) %>% count(hiv3)  #HIV among egos
a
a <- artnetLong %>% filter(ptype == 1) %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% filter(ptype == 1) %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% filter(ptype == 1) %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.main <- cbind(cbind(c("Negative", "Positive", "Unknown", "Total")),
cbind(c(a$n[1], a$n[2], a$n[3], sum(a$n))),
cbind(rbind((100 * a$n[1] / sum(a$n)),
(100 * a$n[2] / sum(a$n)),
(100 * a$n[3] / sum(a$n)),
(100 * sum(a$n) / sum(a$n)))))
# Negative partners
d.neg.part.main <- cbind(cbind(c(b$n[1], b$n[4], b$n[7], c$n[1])),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * b$n[7] / a$n[3]),
(100 * c$n[1] / sum(c$n)))))
# Positive partners
d.pos.part.main <- cbind(cbind(c(b$n[2], b$n[5], b$n[8], c$n[2])),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * b$n[8] / a$n[3]),
(100 * c$n[2] / sum(c$n)))))
# HIV unknown partners
d.unk.part.main <- cbind(cbind(c(b$n[3], b$n[6], b$n[9], c$n[3])),
cbind(rbind((100 * b$n[3] / a$n[1]),
(100 * b$n[6] / a$n[2]),
(100 * b$n[9] / a$n[3]),
(100 * c$n[3] / sum(c$n)))))
table2b.title <- c("Main Partnerships", "", "", "Alters", "", "", "", "", "")
table2b.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%", "Unknown n", "%")
table2b <- rbind(table2b.title, table2b.colnames,
cbind(totalHIV.ego.main, d.neg.part.main, d.pos.part.main, d.unk.part.main))
write.csv(table2b, file = "aim1_table2b.csv")
#### Creating Table 2b ####
table2b.title <- c("HIV Serosorting, stratified by partnership type, crude ARTnet data", "", "", "", "", "", "", "", "")
table2b.title.main <- c("Main Partnerships", "", "", "Alters", "", "", "", "", "")
table2b.title.casual <- c("Casual Partnerships", "", "", "Alters", "", "", "", "", "")
table2b.title.oneoff <- c("One-off Partnerships", "", "", "Alters", "", "", "", "", "")
table2b.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%", "Unknown n", "%")
table2b <- rbind(table2b.title,
table2b.title.main,
cbind(totalHIV.ego.main, d.neg.part.main, d.pos.part.main, d.unk.part.main),
table2b.title.casual,
cbind(totalHIV.ego.casual, d.neg.part.casual, d.pos.part.casual, d.unk.part.casual),
table2b.title.oneoff,
cbind(totalHIV.ego.oneoff, d.neg.part.oneoff, d.pos.part.oneoff, d.unk.part.oneoff))
a <- artnetLong %>% filter(ptype == 1) %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% filter(ptype == 1) %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% filter(ptype == 1) %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.main <- cbind(cbind(c("Negative", "Positive", "Unknown", "Total")),
cbind(c(a$n[1], a$n[2], a$n[3], sum(a$n))),
cbind(rbind((100 * a$n[1] / sum(a$n)),
(100 * a$n[2] / sum(a$n)),
(100 * a$n[3] / sum(a$n)),
(100 * sum(a$n) / sum(a$n)))))
# Negative partners
d.neg.part.main <- cbind(cbind(c(b$n[1], b$n[4], b$n[7], c$n[1])),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * b$n[7] / a$n[3]),
(100 * c$n[1] / sum(c$n)))))
# Positive partners
d.pos.part.main <- cbind(cbind(c(b$n[2], b$n[5], b$n[8], c$n[2])),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * b$n[8] / a$n[3]),
(100 * c$n[2] / sum(c$n)))))
# HIV unknown partners
d.unk.part.main <- cbind(cbind(c(b$n[3], b$n[6], b$n[9], c$n[3])),
cbind(rbind((100 * b$n[3] / a$n[1]),
(100 * b$n[6] / a$n[2]),
(100 * b$n[9] / a$n[3]),
(100 * c$n[3] / sum(c$n)))))
#### Casual partnerships ####
a <- artnetLong %>% filter(ptype == 2) %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% filter(ptype == 2) %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% filter(ptype == 2) %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.casual <- cbind(cbind(c("Negative", "Positive", "Unknown", "Total")),
cbind(c(a$n[1], a$n[2], a$n[3], sum(a$n))),
cbind(rbind((100 * a$n[1] / sum(a$n)),
(100 * a$n[2] / sum(a$n)),
(100 * a$n[3] / sum(a$n)),
(100 * sum(a$n) / sum(a$n)))))
# Negative partners
d.neg.part.casual <- cbind(cbind(c(b$n[1], b$n[4], b$n[7], c$n[1])),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * b$n[7] / a$n[3]),
(100 * c$n[1] / sum(c$n)))))
# Positive partners
d.pos.part.casual <- cbind(cbind(c(b$n[2], b$n[5], b$n[8], c$n[2])),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * b$n[8] / a$n[3]),
(100 * c$n[2] / sum(c$n)))))
# HIV unknown partners
d.unk.part.casual <- cbind(cbind(c(b$n[3], b$n[6], b$n[9], c$n[3])),
cbind(rbind((100 * b$n[3] / a$n[1]),
(100 * b$n[6] / a$n[2]),
(100 * b$n[9] / a$n[3]),
(100 * c$n[3] / sum(c$n)))))
#### One-off partnerships ####
a <- artnetLong %>% filter(ptype == 3) %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% filter(ptype == 3) %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% filter(ptype == 3) %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.oneoff <- cbind(cbind(c("Negative", "Positive", "Unknown", "Total")),
cbind(c(a$n[1], a$n[2], a$n[3], sum(a$n))),
cbind(rbind((100 * a$n[1] / sum(a$n)),
(100 * a$n[2] / sum(a$n)),
(100 * a$n[3] / sum(a$n)),
(100 * sum(a$n) / sum(a$n)))))
# Negative partners
d.neg.part.oneoff <- cbind(cbind(c(b$n[1], b$n[4], b$n[7], c$n[1])),
cbind(rbind((100 * b$n[1] / a$n[1]),
(100 * b$n[4] / a$n[2]),
(100 * b$n[7] / a$n[3]),
(100 * c$n[1] / sum(c$n)))))
# Positive partners
d.pos.part.oneoff <- cbind(cbind(c(b$n[2], b$n[5], b$n[8], c$n[2])),
cbind(rbind((100 * b$n[2] / a$n[1]),
(100 * b$n[5] / a$n[2]),
(100 * b$n[8] / a$n[3]),
(100 * c$n[2] / sum(c$n)))))
# HIV unknown partners
d.unk.part.oneoff <- cbind(cbind(c(b$n[3], b$n[6], b$n[9], c$n[3])),
cbind(rbind((100 * b$n[3] / a$n[1]),
(100 * b$n[6] / a$n[2]),
(100 * b$n[9] / a$n[3]),
(100 * c$n[3] / sum(c$n)))))
#### Creating Table 2b ####
table2b.title <- c("HIV Serosorting, stratified by partnership type, crude ARTnet data", "", "", "", "", "", "", "", "")
table2b.title.main <- c("Main Partnerships", "", "", "Alters", "", "", "", "", "")
table2b.title.casual <- c("Casual Partnerships", "", "", "Alters", "", "", "", "", "")
table2b.title.oneoff <- c("One-off Partnerships", "", "", "Alters", "", "", "", "", "")
table2b.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%", "Unknown n", "%")
table2b <- rbind(table2b.title,
table2b.title.main,
cbind(totalHIV.ego.main, d.neg.part.main, d.pos.part.main, d.unk.part.main),
table2b.title.casual,
cbind(totalHIV.ego.casual, d.neg.part.casual, d.pos.part.casual, d.unk.part.casual),
table2b.title.oneoff,
cbind(totalHIV.ego.oneoff, d.neg.part.oneoff, d.pos.part.oneoff, d.unk.part.oneoff))
write.csv(table2b, file = "aim1_table2b.csv")
write.csv(table2b, file = "aim1_table2b.csv")
table2b <- rbind(table2b.title,
table2b.title.main,
table2b.colnames,
cbind(totalHIV.ego.main, d.neg.part.main, d.pos.part.main, d.unk.part.main),
table2b.title.casual,
table2b.colnames,
cbind(totalHIV.ego.casual, d.neg.part.casual, d.pos.part.casual, d.unk.part.casual),
table2b.title.oneoff,
table2b.colnames,
cbind(totalHIV.ego.oneoff, d.neg.part.oneoff, d.pos.part.oneoff, d.unk.part.oneoff))
write.csv(table2b, file = "aim1_table2b.csv")
source('~/GitHub/PrEP-HIV-Sorting/Data cleaning.R')
a <- artnetLong %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.known <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * (b$n[1] + b$n[2]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[2] + b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5]))))))
# Negative partners
d.neg.part.known <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / (b$n[1] + b$n[2])),
(100 * b$n[4] / (b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
# Positive partners
d.pos.part.known <- cbind(cbind(c(b$n[2], b$n[5], (b$n[2] + b$n[5]))),
cbind(rbind((100 * b$n[2] / (b$n[1] + b$n[2])),
(100 * b$n[5] / (b$n[4] + b$n[5])),
(100 * (b$n[2] + b$n[5]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
table3a.title <- c("Conditional on HIV reported Negative or Positive", "", "", "Alters", "", "", "")
table3a.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%")
table3a.title <- c("HIV serosorting, conditional on HIV reported Negative or Positive", "", "", "Alters", "", "", "")
table3a.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%")
table3a <- rbind(table3a.title, table3a.colnames,
cbind(totalHIV.ego.known, d.neg.part.known, d.pos.part.known))
write.csv(table3a, file = "aim1_table3a .csv")
#### Table 3b - Partnership pairings with NO UNKNOWN, stratified by partnership type ####
#### Main partnerships ####
a <- artnetLong %>% filter(ptype == 1) %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% filter(ptype == 1) %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% filter(ptype == 1) %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.known.main <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * (b$n[1] + b$n[2]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[2] + b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5]))))))
# Negative partners
d.neg.part.known.main <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / (b$n[1] + b$n[2])),
(100 * b$n[4] / (b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
# Positive partners
d.pos.part.known.main <- cbind(cbind(c(b$n[2], b$n[5], (b$n[2] + b$n[5]))),
cbind(rbind((100 * b$n[2] / (b$n[1] + b$n[2])),
(100 * b$n[5] / (b$n[4] + b$n[5])),
(100 * (b$n[2] + b$n[5]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
#### Casual partnerships ####
a <- artnetLong %>% filter(ptype == 2) %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% filter(ptype == 2) %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% filter(ptype == 2) %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.known.casual <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * (b$n[1] + b$n[2]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[2] + b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5]))))))
# Negative partners
d.neg.part.known.casual <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / (b$n[1] + b$n[2])),
(100 * b$n[4] / (b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
# Positive partners
d.pos.part.known.casual <- cbind(cbind(c(b$n[2], b$n[5], (b$n[2] + b$n[5]))),
cbind(rbind((100 * b$n[2] / (b$n[1] + b$n[2])),
(100 * b$n[5] / (b$n[4] + b$n[5])),
(100 * (b$n[2] + b$n[5]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
#### One-off partnerships ####
a <- artnetLong %>% filter(ptype == 3) %>% count(hiv3)  #HIV among egos
b <- artnetLong %>% filter(ptype == 3) %>% count(d_hiv) #HIV by dyad pair
c <- artnetLong %>% filter(ptype == 3) %>% count(p_hiv) #HIV among partners
# HIV distribution among egos
totalHIV.ego.known.oneoff <- cbind(cbind(c("Negative", "Positive", "Total")),
cbind(c((b$n[1] + b$n[2]), (b$n[4] + b$n[5]), (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
cbind(rbind((100 * (b$n[1] + b$n[2]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[2] + b$n[4] + b$n[5]) / (b$n[1] + b$n[2] + b$n[4] + b$n[5]))))))
# Negative partners
d.neg.part.known.oneoff <- cbind(cbind(c(b$n[1], b$n[4], (b$n[1] + b$n[4]))),
cbind(rbind((100 * b$n[1] / (b$n[1] + b$n[2])),
(100 * b$n[4] / (b$n[4] + b$n[5])),
(100 * (b$n[1] + b$n[4]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
# Positive partners
d.pos.part.known.oneoff <- cbind(cbind(c(b$n[2], b$n[5], (b$n[2] + b$n[5]))),
cbind(rbind((100 * b$n[2] / (b$n[1] + b$n[2])),
(100 * b$n[5] / (b$n[4] + b$n[5])),
(100 * (b$n[2] + b$n[5]) / (b$n[1] + b$n[4] + b$n[2] + b$n[5])))))
#### Creating Table 3b ####
table3b.title <- c("HIV Serosorting, conditional on reporting Negative or Positive stratified by partnership type, crude ARTnet data", "", "", "", "", "", "")
table3b.title.main <- c("Main Partnerships", "", "", "Alters", "", "", "")
table3b.title.casual <- c("Casual Partnerships", "", "", "Alters", "", "", "")
table3b.title.oneoff <- c("One-off Partnerships", "", "", "Alters", "", "", "")
table3b.colnames <- c("Egos", "Total N", "%", "Negative n", "%", "Positive n", "%")
table3b <- rbind(table3b.title,
table3b.title.main,
table3b.colnames,
cbind(totalHIV.ego.known.main, d.neg.part.known.main, d.pos.part.known.main),
table3b.title.casual,
table3b.colnames,
cbind(totalHIV.ego.known.casual, d.neg.part.known.casual, d.pos.part.known.casual),
table3b.title.oneoff,
table3b.colnames,
cbind(totalHIV.ego.known.oneoff, d.neg.part.known.oneoff, d.pos.part.known.oneoff))
write.csv(table3b, file = "aim1_table3b.csv")
