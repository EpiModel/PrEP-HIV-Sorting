labs(fill = "HIV among partners",
title = "Complete-case analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
(ss.reclass <- ggplot(ss.reclass.df,
aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.reclass.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Reclassification analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
## Combined cc and reclass
(ss.compare <- ggarrange(ss.cc, ss.reclass,
ncol = 2, nrow = 1,
common.legend = TRUE,
legend = "bottom"))
(ss.cc <- ggplot(ss.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
# geom_label(data = subset(ss.cc.df, perc > 0),
#            aes(label = scales::percent(perc, accuracy = 0.1)),
#            position = position_stack(vjust = 0.5),
#            show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Complete-case analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
(ss.reclass <- ggplot(ss.reclass.df,
aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
# geom_label(data = subset(ss.reclass.df, perc > 0),
#            aes(label = scales::percent(perc, accuracy = 0.1)),
#            position = position_stack(vjust = 0.5),
#            show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Reclassification analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
## Combined cc and reclass
(ss.compare <- ggarrange(ss.cc, ss.reclass,
ncol = 2, nrow = 1,
common.legend = TRUE,
legend = "bottom"))
(ss.cc <- ggplot(ss.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.cc.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Complete-case analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_blank(),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
(ss.reclass <- ggplot(ss.reclass.df,
aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.reclass.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Reclassification analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_blank(),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
## Combined cc and reclass
(ss.compare <- ggarrange(ss.cc, ss.reclass,
ncol = 2, nrow = 1,
common.legend = TRUE,
legend = "bottom"))
(ss.full <- ggplot(ss.full.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Serosorting based on respondent knowledge",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ss.full)
(ss.cc <- ggplot(ss.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.cc.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Complete-case analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_blank(),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
(ss.cc <- ggplot(ss.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.cc.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Complete-case analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_blank(),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ss.comp)
(ss.cc <- ggplot(ss.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.cc.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Complete-case analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ss.comp)
(ss.cc <- ggplot(ss.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.cc.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Complete-case analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title.y = element_blank(),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ss.comp)
(ss.reclass <- ggplot(ss.reclass.df,
aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.reclass.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Reclassification analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_blank(),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ss.comp)
(ss.reclass <- ggplot(ss.reclass.df,
aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.reclass.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Reclassification analysis",
x = "", y = "") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_blank(),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ss.comp)
## Full Sample
ps.table <- prop.table(table(artnetSort$hp, artnetSort$p_hp),1)
ego <- factor(rep(c("Diagnosed HIV\n(11.2%)", "Test-negative, No PrEP\n(54.5%)", "Test-negative, PrEP\n(21.9%)", "HIV unknown\n(12.3%)"), each = 4),
levels = c("Test-negative, No PrEP\n(54.5%)", "Test-negative, PrEP\n(21.9%)", "Diagnosed HIV\n(11.2%)", "HIV unknown\n(12.3%)"))
part <- rep(c("Diagnosed HIV", "No PrEP", "PrEP", "PrEP Unknown"), times = 4)
perc <- c(ps.table[2,2], ps.table[2,1], ps.table[2,3], ps.table[2,4],
ps.table[1,2], ps.table[1,1], ps.table[1,3], ps.table[1,4],
ps.table[3,2], ps.table[3,1], ps.table[3,3], ps.table[3,4],
ps.table[4,2], ps.table[4,1], ps.table[4,3], ps.table[4,4])
ps.full.df <- data.frame(ego, part, perc)
rm(ego, part, perc, ps.table)
(ps.full <- ggplot(ps.full.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP Unknown", "PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "HIV & PrEP sorting based on respondent knowledge",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.full)
## Complete-case analysis
cc.df <- artnetSort %>% filter(!p_hiv == "Unk" & !prep.during.part2 == "Unk" & !hiv3 == "Unk")
ps.table <- prop.table(table(cc.df$hp, cc.df$p_hp),1)
ego <- factor(rep(c("Diagnosed HIV\n(14.0%)", "Test-negative, No PrEP\n(60.2%)", "Test-negative, PrEP\n(25.8%)"), each = 3),
levels = c("Test-negative, No PrEP\n(60.2%)", "Test-negative, PrEP\n(25.8%)", "Diagnosed HIV\n(14.0%)"))
part <- rep(c("Diagnosed HIV", "No PrEP", "PrEP"), times = 3)
perc <- c(ps.table[2,2], ps.table[2,1], ps.table[2,3],
ps.table[1,2], ps.table[1,1], ps.table[1,3],
ps.table[3,2], ps.table[3,1], ps.table[3,3])
ps.cc.df <- data.frame(ego, part, perc)
rm(ego, part, perc, ps.table)
(ps.cc <- ggplot(ps.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "HIV & PrEP sorting based on complete-case analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.cc)
(ps.reclass <- ggplot(ps.reclass.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "HIV & PrEP sorting based on the reclassification analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol3)
## Reclassification analysis
ps.table <- as.data.frame(results(dat = reclass.results, x = "full.sort.p"))
ego <- factor(rep(c("Diagnosed HIV\n(11.2%)", "No PrEP\n(66.9%)", "PrEP\n(21.9%)"), each = 3),
levels = c("No PrEP\n(66.9%)", "PrEP\n(21.9%)", "Diagnosed HIV\n(11.2%)"))
part <- rep(c("Diagnosed HIV", "No PrEP", "PrEP"), times = 3)
perc <- c(ps.table[5,2], ps.table[2,2], ps.table[8,2],
ps.table[4,2], ps.table[1,2], ps.table[7,2],
ps.table[6,2], ps.table[3,2], ps.table[9,2])
ps.reclass.df <- data.frame(ego, part, perc)
rm(ego, part, perc, ps.table)
(ps.reclass <- ggplot(ps.reclass.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "HIV & PrEP sorting based on the reclassification analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol3)
(ps.reclass <- ggplot(ps.reclass.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "HIV & PrEP sorting based on the reclassification analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.re)
(ps.reclass <- ggplot(ps.reclass.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "Reclassification analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.re)
(ps.cc <- ggplot(ps.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "Complete-case analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.cc)
(ss.reclass <- ggplot(ss.reclass.df,
aes(x = ego, y = perc,
fill = factor(part, levels = c("Test-negative or HIV unknown", "Test-negative", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(data = subset(ss.reclass.df, perc > 0),
aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV among partners",
title = "Reclassification analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
text = element_text(size = 12),
axis.title.y = element_blank(),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ss.comp)
## Full Sample
ps.table <- prop.table(table(artnetSort$hp, artnetSort$p_hp),1)
ego <- factor(rep(c("Diagnosed HIV\n(11.2%)", "No PrEP\n(54.5%)", "PrEP\n(21.9%)", "HIV unknown\n(12.3%)"), each = 4),
levels = c("No PrEP\n(54.5%)", "PrEP\n(21.9%)", "Diagnosed HIV\n(11.2%)", "HIV unknown\n(12.3%)"))
part <- rep(c("Diagnosed HIV", "No PrEP", "PrEP", "PrEP Unknown"), times = 4)
perc <- c(ps.table[2,2], ps.table[2,1], ps.table[2,3], ps.table[2,4],
ps.table[1,2], ps.table[1,1], ps.table[1,3], ps.table[1,4],
ps.table[3,2], ps.table[3,1], ps.table[3,3], ps.table[3,4],
ps.table[4,2], ps.table[4,1], ps.table[4,3], ps.table[4,4])
ps.full.df <- data.frame(ego, part, perc)
rm(ego, part, perc, ps.table)
(ps.full <- ggplot(ps.full.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP Unknown", "PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "HIV & PrEP sorting based on respondent knowledge",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.full)
## Complete-case analysis
cc.df <- artnetSort %>% filter(!p_hiv == "Unk" & !prep.during.part2 == "Unk" & !hiv3 == "Unk")
ps.table <- prop.table(table(cc.df$hp, cc.df$p_hp),1)
ego <- factor(rep(c("Diagnosed HIV\n(14.0%)", "Test-negative, No PrEP\n(60.2%)", "Test-negative, PrEP\n(25.8%)"), each = 3),
levels = c("Test-negative, No PrEP\n(60.2%)", "Test-negative, PrEP\n(25.8%)", "Diagnosed HIV\n(14.0%)"))
part <- rep(c("Diagnosed HIV", "No PrEP", "PrEP"), times = 3)
perc <- c(ps.table[2,2], ps.table[2,1], ps.table[2,3],
ps.table[1,2], ps.table[1,1], ps.table[1,3],
ps.table[3,2], ps.table[3,1], ps.table[3,3])
ps.cc.df <- data.frame(ego, part, perc)
rm(ego, part, perc, ps.table)
(ps.cc <- ggplot(ps.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "Complete-case analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "bottom") +
scale_fill_manual(values = mycol.ps.cc)
(ps.cc <- ggplot(ps.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "Complete-case analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.cc)
## Reclassification analysis
ps.table <- as.data.frame(results(dat = reclass.results, x = "full.sort.p"))
ego <- factor(rep(c("Diagnosed HIV\n(11.2%)", "No PrEP\n(66.9%)", "PrEP\n(21.9%)"), each = 3),
levels = c("No PrEP\n(66.9%)", "PrEP\n(21.9%)", "Diagnosed HIV\n(11.2%)"))
part <- rep(c("Diagnosed HIV", "No PrEP", "PrEP"), times = 3)
perc <- c(ps.table[5,2], ps.table[2,2], ps.table[8,2],
ps.table[4,2], ps.table[1,2], ps.table[7,2],
ps.table[6,2], ps.table[3,2], ps.table[9,2])
ps.reclass.df <- data.frame(ego, part, perc)
rm(ego, part, perc, ps.table)
(ps.reclass <- ggplot(ps.reclass.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "Reclassification analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.re)
## Complete-case analysis
cc.df <- artnetSort %>% filter(!p_hiv == "Unk" & !prep.during.part2 == "Unk" & !hiv3 == "Unk")
ps.table <- prop.table(table(cc.df$hp, cc.df$p_hp),1)
ego <- factor(rep(c("Diagnosed HIV\n(14.0%)", "No PrEP\n(60.2%)", "PrEP\n(25.8%)"), each = 3),
levels = c("No PrEP\n(60.2%)", "PrEP\n(25.8%)", "Diagnosed HIV\n(14.0%)"))
part <- rep(c("Diagnosed HIV", "No PrEP", "PrEP"), times = 3)
perc <- c(ps.table[2,2], ps.table[2,1], ps.table[2,3],
ps.table[1,2], ps.table[1,1], ps.table[1,3],
ps.table[3,2], ps.table[3,1], ps.table[3,3])
ps.cc.df <- data.frame(ego, part, perc)
rm(ego, part, perc, ps.table)
(ps.cc <- ggplot(ps.cc.df, aes(x = ego, y = perc,
fill = factor(part, levels = c("PrEP", "No PrEP", "Diagnosed HIV")))) +
geom_bar(stat = "identity") +
scale_y_continuous(labels = scales::percent)) +
geom_label(aes(label = scales::percent(perc, accuracy = 0.1)),
position = position_stack(vjust = 0.5),
show.legend = FALSE, fill = "white") +
labs(fill = "HIV & PrEP among partners",
title = "Complete-case analysis",
x = "Respondents") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
axis.title.y = element_blank(),
text = element_text(size = 12),
strip.text = element_text(size = 12),
legend.position = "right") +
scale_fill_manual(values = mycol.ps.cc)
